# Data Directory

This directory contains all data files used and generated by the Kettler Data Analysis project.

## ğŸ“ Directory Structure

```
data/
â”œâ”€â”€ source/          # Source data files (authoritative datasets)
â”‚   â”œâ”€â”€ skidmore_all_firms_complete.json      # Complete firm data (38 firms)
â”‚   â”œâ”€â”€ skidmore_firms_database.csv           # Firm database (CSV format)
â”‚   â”œâ”€â”€ skidmore_individual_licenses.json    # Individual licenses (JSON)
â”‚   â””â”€â”€ skidmore_individual_licenses.csv      # Individual licenses (CSV)
â”‚
â”œâ”€â”€ scraped/         # Scraped data from external sources
â”‚   â”œâ”€â”€ airbnb_listings_john_carlyle.json
â”‚   â”œâ”€â”€ vrbo_listings_john_carlyle.json
â”‚   â”œâ”€â”€ front_website_listings.json
â”‚   â””â”€â”€ additional_str_listings.json
â”‚
â”œâ”€â”€ analysis/        # Analysis outputs and reports
â”‚   â”œâ”€â”€ dpor_skidmore_connections.csv         # Firm connections analysis
â”‚   â”œâ”€â”€ dpor_validated.csv                   # Validated data with quality flags
â”‚   â”œâ”€â”€ analysis_summary.json                 # Summary statistics
â”‚   â””â”€â”€ data_quality_report.json              # Quality metrics
â”‚
â”œâ”€â”€ raw/             # Raw search results (gitignored)
â”œâ”€â”€ cleaned/         # Cleaned and standardized data (gitignored)
â”œâ”€â”€ vectors/         # Vector embeddings and ETL results
â”‚
â”œâ”€â”€ schema.json      # Complete schema definition (JSON Schema)
â””â”€â”€ SCHEMA.md        # Human-readable schema documentation
```

## ğŸ“Š Database Schema

All datasets follow a normalized schema with clearly defined **Primary Keys (PK)** and **Foreign Keys (FK)**.

### Quick Reference

| Table | Primary Key | Key Foreign Keys | File |
|-------|------------|------------------|------|
| **firms** | `firm_license` | `individual_license` â†’ `individual_licenses.license_number` | `source/skidmore_all_firms_complete.json` |
| **individual_licenses** | `license_number` | None | `source/skidmore_individual_licenses.json` |
| **str_listings** | `listing_id` | None | `scraped/*.json` |
| **firm_connections** | `connection_id` | `firm_license_1`, `firm_license_2` â†’ `firms.firm_license` | `analysis/dpor_skidmore_connections.csv` |
| **analysis_results** | `analysis_id` | None | `analysis/*.json` |

### Schema Documentation

- **Full Schema:** See [`SCHEMA.md`](./SCHEMA.md) for complete documentation
- **JSON Schema:** See [`schema.json`](./schema.json) for machine-readable schema definition

## ğŸ“‹ Source Data (`source/`)

### `skidmore_all_firms_complete.json`

**Primary Key:** `firm_license` (10-digit Virginia DPOR license number)

Complete dataset of 38 real estate firms associated with Caitlin Skidmore as principal broker. This is the **single source of truth** for firm data.

**Key Fields:**
- `firm_license` (PK): 10-digit license number
- `firm_name`: Legal name of the firm
- `address`: Business address
- `state`: Two-letter state code
- `initial_cert_date`: Initial certification date
- `expiration_date`: License expiration date
- `principal_broker`: Must be "SKIDMORE CAITLIN MARIE"
- `individual_license` (FK): Optional reference to individual license

**Status:** âœ… 100% complete (all 38 firms verified)

### `skidmore_individual_licenses.json`

**Primary Key:** `license_number` (10-digit license number)

Individual real estate licenses for Caitlin Skidmore across multiple states (40+ licenses).

**Key Fields:**
- `license_number` (PK): 10-digit license number
- `name`: License holder name ("SKIDMORE, CAITLIN MARIE")
- `address`: Address associated with license
- `license_type`: "Real Estate Individual"
- `board`: "Real Estate Board"

### `skidmore_firms_database.csv`

CSV export of firm data. Use `skidmore_all_firms_complete.json` as the authoritative source.

## ğŸ•·ï¸ Scraped Data (`scraped/`)

Short-term rental listings scraped from various platforms:

- **Airbnb:** `airbnb_listings_john_carlyle.json`
- **VRBO:** `vrbo_listings_john_carlyle.json`
- **Front Website:** `front_website_listings.json`
- **Additional Platforms:** `additional_str_listings.json`

**Schema:** See `str_listings` table in [`SCHEMA.md`](./SCHEMA.md)

## ğŸ“ˆ Analysis Outputs (`analysis/`)

### `dpor_skidmore_connections.csv`

**Primary Key:** `connection_id`
**Foreign Keys:** `firm_license_1`, `firm_license_2` â†’ `firms.firm_license`

Identified connections between firms (same address, same principal broker, etc.).

### `dpor_validated.csv`

Validated firm data with quality flags and validation results.

### `data_quality_report.json`

Data quality metrics including:
- License validation
- Duplicate detection
- Address validation
- Date validation
- Completeness scores

### `analysis_summary.json`

Summary statistics and analysis results.

## ğŸ”— Relationships

### Foreign Key Relationships

1. **firms â†’ individual_licenses** (optional)
   ```
   firms.individual_license â†’ individual_licenses.license_number
   ```
   - Many-to-One (optional)
   - A firm may reference an individual license

2. **firm_connections â†’ firms** (two relationships)
   ```
   firm_connections.firm_license_1 â†’ firms.firm_license
   firm_connections.firm_license_2 â†’ firms.firm_license
   ```
   - Many-to-One (required)
   - Connections reference firms

## âœ… Data Quality

### Validation Rules

**Firms Table:**
- âœ… `firm_license` must be exactly 10 digits
- âœ… `address` cannot be null
- âœ… `expiration_date` must be valid date
- âœ… `principal_broker` must equal "SKIDMORE CAITLIN MARIE"

**Individual Licenses Table:**
- âœ… `license_number` must be exactly 10 digits
- âœ… `name` must equal "SKIDMORE, CAITLIN MARIE"

### Current Status

- **Firms:** 38/38 complete (100%)
- **Individual Licenses:** 40+ licenses documented
- **Data Quality:** See `analysis/data_quality_report.json`

## ğŸ“ Usage Examples

### Load Firm Data (Python)
```python
import json

with open('data/source/skidmore_all_firms_complete.json', 'r') as f:
    data = json.load(f)
    firms = data['companies']

# Access by primary key
firm_by_license = {f['firm_license']: f for f in firms}
```

### Load Firm Data (R)
```r
library(jsonlite)

firms_data <- fromJSON("data/source/skidmore_all_firms_complete.json")
firms <- firms_data$companies

# Access by primary key
firm_by_license <- setNames(firms, firms$firm_license)
```

### Query Firms by State
```python
tx_firms = [f for f in firms if f['state'] == 'TX']
```

### Find Firms with Same Address
```python
from collections import defaultdict

address_groups = defaultdict(list)
for firm in firms:
    address_groups[firm['address']].append(firm)

# Find addresses with multiple firms
multi_firm_addresses = {addr: firms_list
                        for addr, firms_list in address_groups.items()
                        if len(firms_list) > 1}
```

## ğŸ”’ Data Integrity

- **Primary Keys:** All tables have unique primary keys
- **Foreign Keys:** Referential integrity maintained
- **Constraints:** Data validation rules enforced
- **Completeness:** 100% for firms table

## ğŸ“š Additional Documentation

- **Schema Definition:** [`SCHEMA.md`](./SCHEMA.md)
- **JSON Schema:** [`schema.json`](./schema.json)
- **Data Ontology:** [`DATA_ONTOLOGY.md`](./DATA_ONTOLOGY.md) - Concepts, relationships, and terminology
- **Data Architecture:** [`DATA_ARCHITECTURE.md`](./DATA_ARCHITECTURE.md) - Architecture layers, patterns, and best practices
- **Quick Reference:** [`QUICK_REFERENCE.md`](./QUICK_REFERENCE.md)
- **Project README:** [`../README.md`](../README.md)

## âš ï¸ Notes

- Only the directory structure and `.gitkeep` files are tracked in git
- Actual data files are gitignored to keep repository size manageable
- Use `skidmore_all_firms_complete.json` as the single source of truth for firm data
- All dates are in ISO 8601 format (YYYY-MM-DD)
